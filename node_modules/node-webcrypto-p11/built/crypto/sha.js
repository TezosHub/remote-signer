"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const base_1 = require("../base");
class ShaCrypto extends base_1.BaseCrypto {
    static digest(algorithm, data, session) {
        return super.digest.apply(this, arguments)
            .then(() => {
            return new Promise((resolve, reject) => {
                session.createDigest(this.wc2pk11(algorithm)).once(data, (err, data) => {
                    if (err) {
                        reject(err);
                    }
                    else {
                        resolve(data.buffer);
                    }
                });
            });
        });
    }
    static wc2pk11(alg) {
        const res = alg.name.toUpperCase().replace("-", "");
        return { name: res, params: null };
    }
}
exports.ShaCrypto = ShaCrypto;
